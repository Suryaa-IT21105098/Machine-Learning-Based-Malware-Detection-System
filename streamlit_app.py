import os
import streamlit as st

# Set page title and layout
st.set_page_config(
    page_title="Malware Detection System",
    layout="wide",
    initial_sidebar_state="expanded"
)

st.title("Machine Learning Based Malware Detection System")
st.markdown(
    """
    Malware can wreak havoc on a computer and its network. This program uses a 
    [Random Forest Algorithm](https://en.wikipedia.org/wiki/Random_forest) for classification.
    """
)

st.subheader("Try it yourself")

file = st.file_uploader("Upload file(s) to check for malware:", accept_multiple_files=True)

if file:
    for uploaded_file in file:
        with st.spinner(f"Checking {uploaded_file.name}..."):
            # Temporarily save the file
            with open('malwares/tempFile', 'wb') as temp_file:
                temp_file.write(uploaded_file.getvalue())

            # Check for malware
            legitimate = checkFile("malwares/tempFile")
            os.remove("malwares/tempFile")

            # Display result
            if legitimate:
                st.success(f"File {uploaded_file.name} seems *LEGITIMATE*!")
            else:
                st.error(f"File {uploaded_file.name} is probably a **MALWARE**!!!")
# Apply custom CSS for better visuals
st.markdown(
    """
    <style>
    .stButton>button {
        background-color: #4CAF50;
        color: white;
        padding: 8px 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        transition-duration: 0.4s;
        cursor: pointer;
        border-radius: 8px;
    }
    .stButton>button:hover {
        background-color: #45a049;
    }
    </style>
    """,
    unsafe_allow_html=True
)
